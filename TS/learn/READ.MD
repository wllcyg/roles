## 事件循环

进程:多个进程之间相互独立
线程:至少有一个主线程,可以有多个协助线程

## 进程模型

 浏览器进程

 网络进程

 渲染进程 
    
    - 渲染主线程, 每个标签页的线程是单独的
    - 消息队列


 异步
    - setTimeout setInterval
    - xhr
    - addEvenetList
### 如何理解异步?
   
   首先js是单线程的语言,在浏览器的运行中主要是在渲染主线程,渲染主线程主要是弯沉html css js的解析,事件的回调等工作.
   如果使用同步会造成页面的阻塞,页面中的其他功能无法解析造成卡住白屏,所以采用异步的方式来解决,当有异步的任务时,例如:计时器,
   网络,事件监听等,主线程会将其交给其他线程来进行处理,继续执行剩余的任务,当其他线程完成时,会议callback回调任务方式,塞到主线程
   内,加入消息队列的末尾,等待主线程调度执行,这样浏览器不会阻塞.


同一个任务只能在一个队列
* 必须有一个微队列 优先级最高 
* 延时队列 优先级中
* 交互队列 优先级高
* 微队列 优先级最高 主要是包含 promise mutationObserver
   * .then(callback) callback直接会放到微队列
* 计时器准确吗?
   * 计算机本身系统时钟有可能有偏差,非原子钟
   * js 定时器是调用系统的函数有差异
   * 根据事件循环的原理,计时器回调只能在空闲的线程执行,带来了偏差



### 浏览器渲染原理

   - render
      1. 解析HTML文件: 当浏览器的网络主线程收到String,会直接推送一个渲染任务,并且传递给渲染主线程的消息队列,在事件循环的机制中,渲染主线程取出渲染任务,开启渲染进程
         一 、
         - 遇到css,js分别解析,并且会开启一个预先加载得线程,预下载外部的css与js
         * 分别解析出来DOM,CSS树(link代码不会阻塞页面渲染)
         - 遇到css 代码,使用预解析来进行初步解析
         * 遇到js 会停止所有的解析行为
         二 、
         - 样式计算完成,获取DOM树并且都包含样式(会重新计算样式:red这种会变成rgba)
         - 布局(Layout)  {相对于包含块} 内容必须放在行盒中,布局树中不会有display:none的节点
         - 分层(layer) 
         - 绘制(paint)
         - 进行页面分块,将页面分为很多的小区域
         - 将每一个块绘制成位图
         - 最终获取所有的位图,呈现在屏幕上

    什么是重排?
     - 影响布局及尺寸时,该案dom结构,margin padding ,会影响布局树
    什么时重绘?
     - 主要在piant阶段,当一些可见的样式信息更改,就会重新计算,引发repaint,重排必定重绘
    为什么tranform效率高
     因为transform 不会直接影响布局跟绘制流程,只会影响到绘制的最后一个阶段,该阶段在浏览器的合成线程中,所以他不会影响主线程



  收集依赖,并自动调用依赖的函数
  


